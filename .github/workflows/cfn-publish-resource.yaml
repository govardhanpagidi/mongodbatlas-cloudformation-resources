name: Cfn Publishing
on:
  workflow_dispatch:
    inputs:
      regions:
        description: "comma seperated AWS regions"
        default: "us-east-1"
        required: true
      resourceName:
        description: "the folder name of the Resource in this Repo"
        default: ""
        required: true
jobs:
  publish-mongodb-atlas-resource:
    name: publish-mongodb-atlas-resource
    runs-on: ubuntu-20.04
    env:
      RESOURCE_NAME: ${{ github.event.inputs.resourceName }}
      OTHER_PARAMS: ${{ github.event.inputs.otherParams }}
      REGIONS: ${{ github.event.inputs.regions }}
      ATLAS_PUBLIC_KEY: ${{ secrets.ATLAS_PUBLIC_KEY }}
      ATLAS_PRIVATE_KEY: ${{ secrets.ATLAS_PRIVATE_KEY }}
      ATLAS_ORG_ID: ${{ secrets.ATLAS_ORG_ID }}
      AWS_ACCESS_KEY_ID: ${{secrets.AWS_ACCESS_KEY_ID}}
      AWS_SECRET_ACCESS_KEY: ${{secrets.AWS_SECRET_ACCESS_KEY}}
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Run publishing script
        run: |
          ./.github/scripts/cfn-publish.sh

